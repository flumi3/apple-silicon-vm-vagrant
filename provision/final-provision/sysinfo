#!/bin/bash
# =============================================================================
# VM System Information
# =============================================================================
# Usage: sysinfo

echo "╔══════════════════════════════════════════════════════════╗"
echo "║                  VM System Information                   ║"
echo "╚══════════════════════════════════════════════════════════╝"
echo ""

echo "=== System Information ==="
echo "Hostname: $(hostname)"
echo "OS: $(lsb_release -d 2>/dev/null | cut -f2 || cat /etc/os-release | grep PRETTY_NAME | cut -d= -f2 | tr -d '"')"
echo "Kernel: $(uname -r)"
echo "Uptime: $(uptime -p)"
echo "Memory: $(free -h | awk '/^Mem:/ {print $3 "/" $2}')"
echo "Disk: $(df -h / | awk 'NR==2 {print $3 "/" $2 " (" $5 " used)"}')"
echo "IP Address: $(ip route get 1 2>/dev/null | awk '{print $NF;exit}' || hostname -I | awk '{print $1}')"
echo ""

# Show provisioning mode
if [ -f /etc/vm-provision-mode ]; then
    echo "Provisioning Mode: $(cat /etc/vm-provision-mode)"
fi

# Show desktop environment
if [ -f /etc/vm-desktop ]; then
    echo "Desktop: $(cat /etc/vm-desktop)"
fi
echo ""

# Show security tools only in full mode
if [ -f /etc/vm-provision-mode ] && [ "$(cat /etc/vm-provision-mode)" = "full" ]; then
    echo "=== Installed Security Tools ==="
    echo "Nmap: $(nmap --version 2>/dev/null | head -1 || echo 'Not available')"
    echo "Metasploit: $(msfconsole -v 2>/dev/null | head -1 || echo 'Not available')"
    echo "Burp Suite: $(which burpsuite >/dev/null 2>&1 && echo 'Installed' || echo 'Not found')"
    echo "Gobuster: $(gobuster version 2>/dev/null || echo 'Not available')"
    echo ""
fi

echo "=== Custom Commands Available ==="
echo "- helpme             # Show detailed VM guide"
echo "- sysinfo            # This command"
echo "- backup-config      # Backup your configs"
if [ -f /etc/vm-provision-mode ] && [ "$(cat /etc/vm-provision-mode)" = "full" ]; then
    echo "- revshell [ip] [port] # Generate reverse shells"
    echo "- nmap-quick/nmap-full # Quick nmap scans"
    echo "- gobuster-dir [url] # Quick directory busting"
fi
echo ""
